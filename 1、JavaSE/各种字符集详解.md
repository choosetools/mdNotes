###  字符编码和字符集

####  编码与解码

计算机中储存的信息都是用`二进制数`表示的，而我们在屏幕上看到的数字、英文、标点符号、汉字等字符是二进制数转换之后的结果。按照某种规则，将字符存储到计算机中，称为**编码** 。反之，将存储在计算机中的二进制数按照某种规则解析显示出来，称为**解码** 。

**字符编码（Character Encoding）** : 就是一套自然语言的字符与二进制数之间的对应规则。

**编码表**：生活中文字和计算机中二进制的对应规则

**乱码的情况**：按照A规则存储，同样按照A规则解析，那么就能显示正确的文本符号。反之，按照A规则存储，再按照B规则解析，就会导致乱码现象。

```
编码:字符(人能看懂的)--字节(人看不懂的)

解码:字节(人看不懂的)-->字符(人能看懂的)
```

#### 字符集

* **字符集Charset**：也叫编码表。是一个系统支持的所有字符的集合，包括各国家文字、标点符号、图形符号、数字等。

- 计算机要准确的存储和识别各种字符集符号，需要进行字符编码，一套字符集必然至少有一套字符编码。常见字符集有ASCII字符集、GBK字符集、Unicode字符集等。


可见，当指定了**编码**，它所对应的**字符集**自然就指定了，所以**编码**才是我们最终要关心的。

* **ASCII字符集** ：主要用来存储英文字符、阿拉伯数字和常用的标点符号。每个字符占用**`一个字节`**。

  * ASCII码（American Standard Code for Information Interchange，美国信息交换标准代码）：上个世纪60年代，美国制定了一套字符编码，对`英语字符`与二进制位之间的关系，做了统一规定。这被称为ASCII码。
  * ASCII码用于显示现代英语，主要包括控制字符（回车键、退格、换行键等）和可显示字符（英文大小写字符、阿拉伯数字和西文符号）。
  * 基本的ASCII字符集，使用7位（bits）表示一个字符（最前面的1位统一规定为0），使用**单字节**编码，每个字符占用一个字节，共`128个`字符。比如：空格“SPACE”是32（二进制00100000），大写的字母A是65（二进制01000001）。
  * 缺点：不能表示所有字符。

* **ISO-8859-1字符集**：

  * 拉丁码表，别名Latin-1，用于显示欧洲使用的语言，包括荷兰语、德语、意大利语、葡萄牙语等
  * ISO-8859-1使用**单字节**编码，`兼容ASCII编码`。

* **GBxxx字符集**：

  * GB就是国标的意思，是为了`显示中文`而设计的一套字符集。
  * **GB2312**：简体中文码表。一个小于127的字符的意义与原来相同，即向下兼容ASCII码。但两个大于127的字符连在一起时，就表示一个汉字，这样大约可以组合了包含`7000多个简体汉字`，此外数学符号、罗马希腊的字母、日文的假名们都编进去了，这就是常说的"全角"字符，而原来在127号以下的那些符号就叫"半角"字符了。
  * **GBK**：最常用的中文码表。是在GB2312标准基础上的扩展规范，使用了`双字节`编码方案，共收录了`21003个`汉字，完全兼容GB2312标准，同时支持`繁体汉字`以及日韩汉字等。
  * **GB18030**：最新的中文码表。收录汉字`70244个`，采用`多字节`编码，每个字可以由1个、2个或4个字节组成。支持中国国内少数民族的文字，同时支持繁体汉字以及日韩汉字等。
  * **中文字符**是使用**`两个字节`**存储的，但是对于**英文字符、阿拉伯数字以及标点符号**是使用**`一个字节`**存储的，**`兼容ASCII码`**。

* **UTF-8字符集**：

  * UTF-8、UTF-16、UTF-32是三种`将数字转换到程序数据`的编码方案。顾名思义，UTF-8就是每次8个位传输数据，而UTF-16就是每次16个位。其中，**UTF-8 是在互联网上`使用最广`的一种 Unicode 的实现方式**。utf-8可以用来存储世界范围内主要的语言的所有的字符。

  * 互联网工程工作小组（IETF）要求所有互联网协议都必须支持UTF-8编码。所以，我们开发Web应用，也要使用UTF-8编码。UTF-8 是一种`变长的编码方式`。它使用1-4个字节为每个字符编码，编码规则：

    > 1. 128个US-ASCII字符，只需一个字节编码。
    > 2. 拉丁文等字符，需要二个字节编码。 
    > 3. 大部分常用字（含中文），使用三个字节编码。
    > 4. 其他极少使用的Unicode辅助字符，使用四字节编码。

    **`utf-8也向下兼容ASCII码`**。

- 举例

Unicode符号范围  | UTF-8编码方式

```
(十六进制)           | （二进制）

————————————————————|—–—–—–—–—–—–—–—–—–—–—–—–—–—–

0000 0000-0000 007F | 0xxxxxxx（兼容原来的ASCII）

0000 0080-0000 07FF | 110xxxxx 10xxxxxx

0000 0800-0000 FFFF | 1110xxxx 10xxxxxx 10xxxxxx

0001 0000-0010 FFFF | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx

以上，就是utf-8使用不同字节存储数据时，二进制数据使用不同方式开头来进行区别。
```

![image-20220525164636164](.\images\image-20220525164636164.png)

- 小结

![字符集](.\images\字符集.jpg)

> 注意：在中文操作系统上，ANSI（美国国家标准学会、AMERICAN NATIONAL STANDARDS INSTITUTE: ANSI）编码即为GBK；在英文操作系统上，ANSI编码即为ISO-8859-1。



**问题：**

char占用两个字节，但是对于utf-8来说，我们知道中文的字符占用3个字节。那到底存储的中文字符（使用uft-8字符集编码）到底是占两个字节还是三个字节呢？

**答：**

我们所说的字符集占用的字节，指的是存储在文件中占用的空间，而一个char字符占用两个字节，指的是在内存中占用的空间。

如果我们将char字符存储到文件中，是根据字符集来存储的，如果使用的是GBK，中文字符就是占用两个字节；如果使用的是utf-8，中文字符就是占用三个字节。

比如，要去存储'a'字符，在文件中，无论使用ASCII码，还是GBK或者utf-8，都是使用一个字节存储；但是在内存中，'a'都是使用两个字节存储。

即：

> **在`内存`中，无论是中文字符，还是英文字符，都是使用`两个字节`来存储**。
>
> 而**在`文件`中，才会因编码集的不同，使用`不同数量的字节`存储字符。**
>
> 
>
> **内存中实际上使用的是`Unicode字符集`存储数据的。**



* **Unicode字符集** ：

  * Unicode编码为表达`任意语言的任意字符`而设计，也称为统一码、标准万国码。Unicode 将世界上**所有的文字**用**`2个字节`**统一进行编码，为每个字符设定唯一的二进制编码，以满足跨语言、跨平台进行文本处理的要求。所以，**Unicode字符集无法向下兼容`ASCII码`**。

  - Unicode 的缺点：这里有三个问题：
    - 第一，英文字母只用一个字节表示就够了，如果用更多的字节存储是`极大的浪费`。
    - 第二，如何才能`区别Unicode和ASCII`？计算机怎么知道两个字节表示一个符号，而不是分别表示两个符号呢？
    - 第三，如果和GBK等双字节编码方式一样，用最高位是1或0表示两个字节和一个字节，就少了很多值无法用于表示字符，`不够表示所有字符`。

  - Unicode在很长一段时间内无法推广，直到互联网的出现，为解决Unicode如何在网络上传输的问题，于是面向传输的众多 UTF（UCS Transfer Format）标准出现。具体来说，有三种编码方案，UTF-8、UTF-16和UTF-32。



由于以上的原因，Unicode字符集只能用于内存中字符的存储，无法用于文件当中。一般在文件当中，使用最多的就是utf-8。